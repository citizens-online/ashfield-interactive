---
title: "Digital Inclusion in Ashfield district"
output: 
  flexdashboard::flex_dashboard:
    storyboard: true
    theme: cosmo
    css: co_flex.css
    favicon: favicon.png
mainfont: Source Sans Pro
---

```{r setup, include=FALSE}

library(here)
library(dplyr)
library(flexdashboard)
library(leaflet)
library(stringr)
library(tmap)

full_data <- readRDS(here("rds_data/full_data.Rds"))
digitypes_sf <- readRDS(here("rds_data/digitypes_sf.Rds"))
community_sf <- readRDS(here("rds_data/community_sf.Rds"))
ofcom_data_sf <- readRDS(here("rds_data/ofcom_data_sf.Rds"))
ward_boundaries <- readRDS(here("rds_data/ward_boundaries.Rds"))
district_boundary <- readRDS(here("rds_data/district_boundary.Rds"))

star_icon <- tmap_icons(here("star_fill.png"), width = 24, height = 24)
tmap_mode("view")
tmap_options(basemaps = leaflet::providers$CartoDB.Positron,
             fontfamily = "Source Sans Pro")

```

### Areas of Ashfield district with higher digital exclusion risk related to age. Digital exclusion risk is particuarly acute where older people are living alone and/or are poorer. Specific numbers can be seen in a pop-up when you click on an area. Layers may be turned on and off using the layers tool at the top left.


```{r over65_tmap}


full_data_age <- full_data %>% 
  mutate(
    over65_pct = round(
      100*over65_population/(working_age_population+over65_population), 1
      )
    ) %>% 
  mutate_at(vars(lsoa11nm), ~ str_replace(., "^Ashfield ", "")) %>% 
  select(lsoa11nm, over65_population, wd19nm, over65_pct, one_person_household_aged_65_and_over, pc_aug_19)

age_map <- tm_shape(full_data_age, name = "Age by LSOA (%)") +
      tm_polygons("over65_pct",
              title = "% adult population aged 65+",
              alpha = 0.6,
              border.col = "grey50",
              border.alpha = 0.6,
              lwd = 1,
              palette = "Purples",
              style = "log10",
              popup.vars = c("Ward" = "wd19nm",
                             "% adult popn. aged 65+" = "over65_pct",
                             "Popn. aged 65+" = "over65_population",
                             "Older people living alone" = "one_person_household_aged_65_and_over",
                             "Pension Credit claim hotspots" = "pc_aug_19")
              ) +
    # tm_text("over65_population", size = 1, col = "grey22") +
  
  tm_shape(full_data_age, name = "Older people living alone") +
    tm_polygons("one_person_household_aged_65_and_over",
                title = "People aged 65+ living alone",
                alpha = 0.5,
                border.col = "grey50",
                border.alpha = 0.5,
                lwd = 1,
                palette = "Purples",
                style = "log10",
                popup.vars = c("Ward" = "wd19nm",
                             "% adult popn. aged 65+" = "over65_pct",
                             "Popn. aged 65+" = "over65_population",
                             "Older people living alone" = "one_person_household_aged_65_and_over",
                             "Pension Credit claim hotspots" = "pc_aug_19")
                ) +
  
  tm_shape(dplyr::slice_max(full_data_age, order_by = pc_aug_19, n = 5), name = "Pension Credit claims") +
    tm_borders(col = "deeppink", lwd = 2, alpha = 0.7) +
  
  tm_shape(district_boundary, name = "District boundary") +
    tm_borders(col = "lawngreen", lwd = 4, alpha = 0.5, group = NA) +
  
  tm_shape(select(ward_boundaries, wd19nm), name = "Ward boundaries") +
    tm_borders(col = "gold1", lwd = 2, alpha = 0.2) +

  tm_shape(community_sf, name = "Community assets") +
    tm_markers(shape = star_icon, popup.vars = "type")

tmap_leaflet(age_map) %>% 
  leaflet::hideGroup(c("Population aged 65+", "Ward boundaries", "Community assets"))

```

***

Some LSOAs in the north of the district have high proportions of older residents, particularly in Skegby ward and in Stanton Hill & Teversal.
In the south, the village of Underwood and one area in Hucknall North also have relatively old populations.
When the map of community assets is overlaid, we can see that these areas are also not well served by community centres or halls.

While age is generally associated with digital exclusion, particular groups of older people are even more likely to be excluded - those who live alone and those who are poorer.

When we examine the distribution of older people living alone, we find a different pattern, with these being more likely to live in the towns, especially in Sutton and in the centre of Hucknall, as well as in Kirkby (Summit and Kingsway wards).
The highest numbers of Pension Credit claimants (poorer older people) are found in the same areas.
(The 5 LSOAs bordered with pink are those with the highest numbers of Pension Credit claimants.)
Being more urban, these areas have community centres and potential support venues not too far away, but very few actually in the highest-risk LSOAs themselves.


### Areas of Ashfield district with higher digital exclusion risk related to disability. Disabled people are %%% less likely to be online than non-disabled people. We estimate the disabled population in an area by using claimant numbers for various disability-related benefits (DLA, ESA, PIP). Layers may be turned on and off using the layers tool at the top left.


```{r disability_tmap}

full_data_dis <- full_data %>% 
  mutate(
    disab_pct = round(
      100*comb_disability/(working_age_population+over65_population), 1
      )
    ) %>% 
  mutate_at(vars(lsoa11nm), ~ str_replace(., "^Ashfield ", "")) %>% 
  select(lsoa11nm, wd19nm, comb_disability, disab_pct, HDDDec)

disab_map <- tm_shape(full_data_dis, name = "Disability prevalence (% popn) (approx.)") +
      tm_polygons("disab_pct",
              title = "% adult population receiving disability benefits",
              alpha = 0.7,
              border.col = "grey50",
              border.alpha = 0.7,
              lwd = 1,
              palette = "Purples",
              style = "cont",
              n = 4,
              popup.vars = c("Ward" = "wd19nm",
                             "% adults receiving disability benefits (approx.)" = "disab_pct",
                             "Adults receiving disability benefits (approx.)" = "comb_disability",
                             "HDD Decile" = "HDDDec")
              ) +
    # tm_text("over65_population", size = 1, col = "grey22") +
  
  tm_shape(filter(full_data_dis, HDDDec %in% 1), name = "LSOAs with highest Health & Disability Deprivation") +
    tm_borders(col = "deeppink", lwd = 2, alpha = 0.4) +
  
  tm_shape(district_boundary, name = "District boundary") +
    tm_borders(col = "lawngreen", lwd = 4, alpha = 0.5, group = NA) +
  
  tm_shape(select(ward_boundaries, wd19nm), name = "Ward boundaries") +
    tm_borders(col = "gold1", lwd = 2, alpha = 0.2) +

  tm_shape(community_sf, name = "Community assets") +
    tm_markers(shape = star_icon, popup.vars = "type")

tmap_leaflet(disab_map) %>% 
  leaflet::hideGroup(c("Ward boundaries", "Community assets"))

```

***

While there are significant numbers of disabled people in every LSOA, the highest numbers are found particularly in Sutton (in Carsic and Leamington wards) and to a lesser extent in Kirkby (Summit and Abbey Hill wards).

When the community assets layer is overlaid, we can see that in a few areas such as Abbey Hill and in the southern part of Leamington ward, there are very few or no places where disabled residents might be able to access digital skills support within their neighbourhood.

The data shown here incorporates claims data from the DWP ([StatXplore][statx]) for the disability-related benefits DLA, ESA and PIP.
The claimant numbers are summed together here, but these benefits are not all mutually exclusive, so the figures must be taken as approximations.
Additionally, not all who are disabled in a way that limits their day-to-day activities may be claiming one of these benefits.

The [2019 English Indices of Deprivation][eimd] includes an index of health and disability deprivation, where LSOAs are scored and ranked nationally.
Those LSOAs in Ashfield within the 10% most deprived in this index are highlighted, for comparison (n = 10).

Among these, three LSOAs (in Huthwaite & Brierley, Central & New Cross, and Skegby) are found outside the three target wards identified by the Citizens Online analysis.
These areas may therefore have above-average digital inclusion needs, and places such as the nearby (respectively) Huthwaite, Sutton and Skegby libraries and New Cross Community Church may be able to host digital support sessions for residents.

[eimd]: https://www.gov.uk/government/statistics/english-indices-of-deprivation-2019
[statx]: https://stat-xplore.dwp.gov.uk/




### This map shows the number of Housing Benefit and Universal Credit claimants for each LSOA, as a rough measure of income deprivation. Data from Ofcom showing postcodes where some or all premises cannot access Superfast broadband is overlaid, with the size of the dot representing the number of premises affected.


```{r income_tmap}

full_data_inc <- full_data %>% 
  mutate(hbplusuc = uc_claimants+hb_claimants) %>% 
  mutate(
    incom_pct = round(
      100*hbplusuc/(working_age_population+over65_population), 1
      )
    ) %>% 
  mutate_at(vars(lsoa11nm), ~ str_replace(., "^Ashfield ", "")) %>% 
  select(lsoa11nm, wd19nm, hbplusuc, incom_pct, lsoa_hh_no_sfbb)

incom_map <- tm_shape(full_data_inc, name = "Income deprivation prevalence (% adult popn)") +
      tm_polygons("incom_pct",
              title = "% adult population receiving UC or HB",
              alpha = 0.7,
              border.col = "grey50",
              border.alpha = 0.7,
              lwd = 1,
              palette = "Purples",
              style = "cont",
              n = 4,
              popup.vars = c("Ward" = "wd19nm",
                             "% adult population receiving UC or HB" = "incom_pct",
                             "Adults receiving UC or HB" = "hbplusuc",
                             "Households unable to access Superfast broadband" = "lsoa_hh_no_sfbb"
                             )
              ) +
  
  tm_shape(district_boundary, name = "District boundary") +
    tm_borders(col = "lawngreen", lwd = 4, alpha = 0.5, group = NA) +
  
  tm_shape(select(ward_boundaries, wd19nm), name = "Ward boundaries") +
    tm_borders(col = "gold1", lwd = 2, alpha = 0.2) +

  tm_shape(community_sf, name = "Community assets") +
    tm_markers(shape = star_icon, popup.vars = "type") +
  
  tm_shape(filter(ofcom_data_sf, no_sfbb_pc > 0), name = "Postcodes with premises unable to access SFBB") +
    tm_dots(size = "no_sfbb_pc", col = "red2", shape = 21, title = "Premises without Superfast (by postcode)", legend.show = FALSE, alpha = 0.5, perceptual = FALSE, style = "cont", scale = 0.5, popup.vars = FALSE)

tmap_leaflet(incom_map) %>% 
  leaflet::hideGroup(c("Ward boundaries", "Community assets"))

```

***

The highest numbers of people on lower incomes, as represented by HB and UC claims, are found within areas of Leamington, Summit, Central & New Cross, Abbey Hill and Carsic wards. None of these LSOAs has a significant problem with lack of broadband connectivity.

These are areas where people may not be easily able to buy, repair or replace devices due to cost, may not have a mobile data allowance, or be able to afford a decent broadband connection.

Areas with poorer broadband availability are represented by the circles: these are scattered throughout the district but with particular clusters in Larwood, Annesley & Kirkby Woodhouse and Stanton Hill & Teversal wards.
